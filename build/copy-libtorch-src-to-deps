#!/bin/bash

# This is a script that copies the relevant binaries and header files from a build of
# LibTorch, into our own 'deps' directory. Once LibTorch is more stable, and supported
# on Linux, then we can stop doing this. But for now, there's no saner way.
# Before this script can work, you must checkout PyTorch 1.0.1 branch, and build
# it from source, with CUDA support.

if [ "$1" == "" ]; then
	echo "You must specify the 'build' directory of PyTorch"
	exit 1
fi
SRC=$1
DST=deps/torch

mkdir -p $DST/lib
mkdir -p $DST/include
cp -P $SRC/lib/libc10.so $DST/lib/
cp -P $SRC/lib/libc10_cuda.so $DST/lib/
cp -P $SRC/lib/libcaffe2.so $DST/lib/
cp -P $SRC/lib/libtorch.so $DST/lib/
cp -P $SRC/lib/libtorch.so.1 $DST/lib/

cp -r $SRC/lib.linux-x86_64-3.6/torch/lib/include $DST/
